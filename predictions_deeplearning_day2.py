# -*- coding: utf-8 -*-
"""Deeplearning_DAY2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1xMimUE8MHQdkxZeHPS3VGUPKR3_2vPDS
"""

import numpy as np
import os
from os.path import join
# from IPython.display import Imagemage, display
from keras.applications.resnet50 import preprocess_input, decode_predictions
# from tensorflow.keras.applications.resnet50 import preprocess_input
from tensorflow.keras.applications import ResNet50
from tensorflow.keras.preprocessing.image import load_img, img_to_array

dog_image_dir = '/content/drive/My Drive/Deeplearning Stuff/test/dogs'

dog_paths = [join(dog_image_dir,filename) for filename in ['dog1.jpg','dog2.jpeg','dog3.jpg','dog4.jpg','dog5.jpg']]

# not_dog_image_dir = 'test/not_dogs'
# not_dog_paths = [join(not_dog_image_dir, filename) for filename in ['823536.jpg','99890.jpg']]

img_paths = dog_paths #+ not_dog_paths
# img_paths=['dog1.jpg']
print(img_paths)

image_size=224
def read_and_prep_images(img_paths,img_height=image_size,img_width=image_size):
    imgs=[load_img(img_path,target_size=(img_height,img_width)) for img_path in img_paths]
    img_array=np.array([img_to_array(img) for img in imgs])
    output=[preprocess_input(img_array)]
    return output

my_model=ResNet50(weights='imagenet')
test_data=read_and_prep_images(img_paths)
preds=my_model.predict(test_data[0])

print(len(test_data[0]))

most_likely_labels=decode_predictions(preds, top=3)
print(most_likely_labels)

for i,img_path in enumerate(img_paths):
    display(Image(img_path,height=100))
    print(most_likely_labels[i])

